{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ASUS\\\\Desktop\\\\azure-search-react-template\\\\src\\\\pages\\\\Search\\\\Search.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { useLocation, useHistory } from \"react-router-dom\";\nimport Results from '../../components/Results/Results';\nimport Pager from '../../components/Pager/Pager';\nimport Facets from '../../components/Facets/Facets';\nimport SearchBar from '../../components/SearchBar/SearchBar';\nimport \"./Search.css\";\nexport default function Search() {\n  _s();\n\n  var _URLSearchParams$get, _URLSearchParams$get2, _URLSearchParams$get3;\n\n  let location = useLocation();\n  let history = useHistory();\n  const [results, setResults] = useState([]);\n  const [resultCount, setResultCount] = useState(0);\n  const [currentPage, setCurrentPage] = useState(1);\n  const [q, setQ] = useState((_URLSearchParams$get = new URLSearchParams(location.search).get('q')) !== null && _URLSearchParams$get !== void 0 ? _URLSearchParams$get : \"*\");\n  const [top] = useState((_URLSearchParams$get2 = new URLSearchParams(location.search).get('top')) !== null && _URLSearchParams$get2 !== void 0 ? _URLSearchParams$get2 : 8);\n  const [skip, setSkip] = useState((_URLSearchParams$get3 = new URLSearchParams(location.search).get('skip')) !== null && _URLSearchParams$get3 !== void 0 ? _URLSearchParams$get3 : 0);\n  const [filters, setFilters] = useState([]);\n  const [facets, setFacets] = useState({});\n  const [isLoading, setIsLoading] = useState(true);\n  let resultsPerPage = top;\n  useEffect(() => {\n    setIsLoading(true);\n    const body = {\n      q: q,\n      top: top,\n      skip: skip,\n      filters: filters\n    };\n    axios.post('/api/search', body).then(response => {\n      setResults(response.data.results);\n      setFacets(response.data.facets);\n      setResultCount(response.data.count);\n      setIsLoading(false);\n    }).catch(error => {\n      console.log(error);\n      setIsLoading(false);\n    });\n  }, [q, top, skip, filters]);\n\n  let postSearchHandler = searchTerm => {\n    // pushing the new search term to history when q is updated\n    // allows the back button to work as expected when coming back from the details page\n    history.push('/search?q=' + searchTerm);\n    setCurrentPage(1);\n    setSkip(0);\n    setFilters([]);\n    setQ(searchTerm);\n  };\n\n  let updatePagination = newPageNumber => {\n    setCurrentPage(newPageNumber);\n    setSkip((newPageNumber - 1) * top);\n  };\n\n  var body;\n\n  if (isLoading) {\n    body = /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(CircularProgress, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }\n    }));\n  } else {\n    body = /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-md-9\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Results, {\n      documents: results,\n      top: top,\n      skip: skip,\n      count: resultCount,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Pager, {\n      className: \"pager-style\",\n      currentPage: currentPage,\n      resultCount: resultCount,\n      resultsPerPage: resultsPerPage,\n      setCurrentPage: updatePagination,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(\"main\", {\n    className: \"main main--search container-fluid\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"row\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"col-md-3\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"search-bar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(SearchBar, {\n    postSearchHandler: postSearchHandler,\n    q: q,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(Facets, {\n    facets: facets,\n    filters: filters,\n    setFilters: setFilters,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 11\n    }\n  })), body));\n}\n\n_s(Search, \"NIeRPxscrg/rDo7y3qZJXMlmVgY=\", false, function () {\n  return [useLocation, useHistory];\n});\n\n_c = Search;\n\nvar _c;\n\n$RefreshReg$(_c, \"Search\");","map":{"version":3,"sources":["C:/Users/ASUS/Desktop/azure-search-react-template/src/pages/Search/Search.js"],"names":["React","useEffect","useState","axios","CircularProgress","useLocation","useHistory","Results","Pager","Facets","SearchBar","Search","location","history","results","setResults","resultCount","setResultCount","currentPage","setCurrentPage","q","setQ","URLSearchParams","search","get","top","skip","setSkip","filters","setFilters","facets","setFacets","isLoading","setIsLoading","resultsPerPage","body","post","then","response","data","count","catch","error","console","log","postSearchHandler","searchTerm","push","updatePagination","newPageNumber"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport CircularProgress  from '@material-ui/core/CircularProgress';\r\nimport { useLocation, useHistory } from \"react-router-dom\";\r\n\r\nimport Results from '../../components/Results/Results';\r\nimport Pager from '../../components/Pager/Pager';\r\nimport Facets from '../../components/Facets/Facets';\r\nimport SearchBar from '../../components/SearchBar/SearchBar';\r\n\r\nimport \"./Search.css\";\r\n\r\nexport default function Search() {\r\n  \r\n  let location = useLocation();\r\n  let history = useHistory();\r\n  \r\n  const [ results, setResults ] = useState([]);\r\n  const [ resultCount, setResultCount ] = useState(0);\r\n  const [ currentPage, setCurrentPage ] = useState(1);\r\n  const [ q, setQ ] = useState(new URLSearchParams(location.search).get('q') ?? \"*\");\r\n  const [ top ] = useState(new URLSearchParams(location.search).get('top') ?? 8);\r\n  const [ skip, setSkip ] = useState(new URLSearchParams(location.search).get('skip') ?? 0);\r\n  const [ filters, setFilters ] = useState([]);\r\n  const [ facets, setFacets ] = useState({});\r\n  const [ isLoading, setIsLoading ] = useState(true);\r\n\r\n  let resultsPerPage = top;\r\n  \r\n  useEffect(() => {\r\n    setIsLoading(true);\r\n    const body = {\r\n      q: q,\r\n      top: top,\r\n      skip: skip,\r\n      filters: filters\r\n    };\r\n\r\n    axios.post( '/api/search', body)\r\n        .then( response => {\r\n            setResults(response.data.results);\r\n            setFacets(response.data.facets);\r\n            setResultCount(response.data.count);\r\n            setIsLoading(false);\r\n        } )\r\n        .catch(error => {\r\n            console.log(error);\r\n            setIsLoading(false);\r\n        });\r\n    \r\n  }, [q, top, skip, filters]);\r\n\r\n\r\n  let postSearchHandler = (searchTerm) => {\r\n    // pushing the new search term to history when q is updated\r\n    // allows the back button to work as expected when coming back from the details page\r\n    history.push('/search?q=' + searchTerm);  \r\n    setCurrentPage(1);\r\n    setSkip(0);\r\n    setFilters([]);\r\n    setQ(searchTerm);\r\n  }\r\n\r\n  let updatePagination = (newPageNumber) => {\r\n    setCurrentPage(newPageNumber);\r\n    setSkip((newPageNumber-1) * top);\r\n  }\r\n\r\n  var body;\r\n  if (isLoading) {\r\n    body = (\r\n      <div className=\"col-md-9\">\r\n        <CircularProgress />\r\n      </div>);\r\n  } else {\r\n    body = (\r\n      <div className=\"col-md-9\">\r\n        <Results documents={results} top={top} skip={skip} count={resultCount}></Results>\r\n        <Pager className=\"pager-style\" currentPage={currentPage} resultCount={resultCount} resultsPerPage={resultsPerPage} setCurrentPage={updatePagination}></Pager>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <main className=\"main main--search container-fluid\">\r\n      \r\n      <div className=\"row\">\r\n        <div className=\"col-md-3\">\r\n          <div className=\"search-bar\">\r\n            <SearchBar postSearchHandler={postSearchHandler} q={q}></SearchBar>\r\n          </div>\r\n          <Facets facets={facets} filters={filters} setFilters={setFilters}></Facets>\r\n        </div>\r\n        {body}\r\n      </div>\r\n    </main>\r\n  );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}